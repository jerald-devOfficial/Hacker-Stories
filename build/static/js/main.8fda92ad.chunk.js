(this["webpackJsonphacker-stories"]=this["webpackJsonphacker-stories"]||[]).push([[0],{29:function(e,t,n){},50:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(8),s=n.n(a),o=(n(29),n(11)),i=n.n(o),u=n(20),l=n(4),j=n(5),b=n(21),d=n.n(b),h=(n(50),n(1)),O=function(e){var t=e.id,n=e.value,c=e.type,a=void 0===c?"text":c,s=e.onInputChange,o=e.isFocused,i=e.children,u=r.a.useRef();return r.a.useEffect((function(){o&&u.current&&u.current.focus()}),[o]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("label",{htmlFor:t,className:"label",children:i}),"\xa0",Object(h.jsx)("input",{ref:u,id:t,type:a,value:n,onChange:s,className:"input"})]})},p=function(e){var t=e.searchTerm,n=e.onSearchInput,c=e.onSearchSubmit;return Object(h.jsxs)("form",{onSubmit:c,className:"search-form",children:[Object(h.jsx)(O,{id:"search",isFocused:!0,onInputChange:n,value:t,children:Object(h.jsx)("strong",{children:"Search: "})}),Object(h.jsx)("button",{className:"button button_large",type:"submit",disabled:!t,children:"Submit"})]})},f=n(22),m=n.n(f),y=n(6),x={NONE:function(e){return e},TITLE:function(e){return Object(y.sortBy)(e,"title")},AUTHOR:function(e){return Object(y.sortBy)(e,"author")},COMMENT:function(e){return Object(y.sortBy)(e,"num_comments").reverse()},POINT:function(e){return Object(y.sortBy)(e,"points").reverse()}},v=function(e){var t=e.item,n=e.onRemoveItem;return Object(h.jsxs)("div",{className:"item",style:{display:"flex"},children:[Object(h.jsx)("span",{style:{width:"40%"},children:Object(h.jsx)("a",{href:t.url,children:t.title})}),Object(h.jsx)("span",{style:{width:"30%"},children:t.author}),Object(h.jsx)("span",{style:{width:"10%"},children:t.num_comments}),Object(h.jsx)("span",{style:{width:"10%"},children:t.points}),Object(h.jsx)("span",{style:{width:"10%"},children:Object(h.jsx)("button",{className:"button button_small",type:"button",onClick:function(){return n(t)},children:Object(h.jsx)(m.a,{size:"sm"})})})]})},S=function(e){var t=e.list,n=e.onRemoveItem,r=Object(c.useState)({sortKey:"NONE",isReverse:!1}),a=Object(j.a)(r,2),s=a[0],o=a[1],i=function(e){var t=s.sortKey===e&&!s.isReverse;o({sortKey:e,isReverse:t})},u=x[s.sortKey],l=s.isReverse?u(t).reverse():u(t);return Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{style:{display:"flex"},children:[Object(h.jsx)("span",{style:{width:"40%"},children:Object(h.jsx)("button",{type:"button",onClick:function(){return i("TITLE")},children:"Title"})}),Object(h.jsx)("span",{style:{width:"30%"},children:Object(h.jsx)("button",{type:"button",onClick:function(){return i("AUTHOR")},children:"Author"})}),Object(h.jsx)("span",{style:{width:"10%"},children:Object(h.jsx)("button",{type:"button",onClick:function(){return i("COMMENT")},children:"Comments"})}),Object(h.jsxs)("span",{style:{width:"10%"},children:[" ",Object(h.jsx)("button",{type:"button",onClick:function(){return i("POINT")},children:"Points"})]}),Object(h.jsx)("span",{style:{width:"10%"},children:"Actions"})]}),l.map((function(e){return Object(h.jsx)(v,{item:e,onRemoveItem:n},e.objectID)}))]})},g="query=",E=function(e,t){return"".concat("https://hn.algolia.com/api/v1").concat("/search","?").concat(g).concat(e,"&").concat("page=").concat(t)},I=function(e,t){switch(t.type){case"STORIES_FETCH_INIT":return Object(l.a)(Object(l.a)({},e),{},{isLoading:!0,isError:!1});case"STORIES_FETCH_SUCCESS":return Object(l.a)(Object(l.a)({},e),{},{isLoading:!1,isError:!1,data:0===t.payload.page?t.payload.list:e.data.concat(t.payload.list),page:t.payload.page});case"STORIES_FETCH_FAILURE":return Object(l.a)(Object(l.a)({},e),{},{isLoading:!1,isError:!0});case"REMOVE_STORY":return Object(l.a)(Object(l.a)({},e),{},{data:e.data.filter((function(e){return t.payload.objectID!==e.objectID}))});default:throw new Error}},T=function(e){return e.substring(e.lastIndexOf("?")+1,e.lastIndexOf("&")).replace(g,"")},w=function(e){var t=e.lastSearches,n=e.onLastSearch;return Object(h.jsx)(h.Fragment,{children:t.map((function(e,t){return Object(h.jsx)("button",{type:"button",onClick:function(){return n(e)},children:e},e+t)}))})},R=function(){var e=function(e,t){var n=r.a.useRef(!1),c=r.a.useState(localStorage.getItem(e)||t),a=Object(j.a)(c,2),s=a[0],o=a[1];return r.a.useEffect((function(){n.current?localStorage.setItem(e,s):n.current=!0}),[s,e]),[s,o]}("search","React"),t=Object(j.a)(e,2),n=t[0],c=t[1],a=r.a.useState([E(n,0)]),s=Object(j.a)(a,2),o=s[0],l=s[1],b=r.a.useReducer(I,{data:[],page:0,isLoading:!1,isError:!1}),O=Object(j.a)(b,2),f=O[0],m=O[1],y=r.a.useCallback(Object(u.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m({type:"STORIES_FETCH_INIT"}),e.prev=1,t=o[o.length-1],e.next=5,d.a.get(t);case 5:n=e.sent,m({type:"STORIES_FETCH_SUCCESS",payload:{list:n.data.hits,page:n.data.page}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),m({type:"STORIES_FETCH_FAILURE"});case 12:case"end":return e.stop()}}),e,null,[[1,9]])}))),[o]);r.a.useEffect((function(){y()}),[y]);var x=r.a.useCallback((function(e){m({type:"REMOVE_STORY",payload:e})}),[]),v=function(e,t){var n=E(e,t);l(o.concat(n))},g=function(e){return e.reduce((function(e,t,n){var c=T(t);return 0===n?e.concat(c):c===e[e.length-1]?e:e.concat(c)}),[]).slice(-6).slice(0,-1)}(o),R=r.a.useMemo((function(){return function(e){return e.data.reduce((function(e,t){return e+t.num_comments}),0)}(f)}),[f]);return Object(h.jsxs)("div",{className:"container",children:[Object(h.jsxs)("h1",{className:"headline-primary",children:["My Hacker Stories with ",R," comments."]}),Object(h.jsx)(p,{searchTerm:n,onSearchInput:function(e){c(e.target.value)},onSearchSubmit:function(e){v(n,0),e.preventDefault()}}),Object(h.jsx)(w,{lastSearches:g,onLastSearch:function(e){c(e),v(e,0)}}),f.isError&&Object(h.jsx)("p",{children:"Something went wrong ..."}),Object(h.jsx)(S,{list:f.data,onRemoveItem:x}),f.isLoading?Object(h.jsx)("p",{children:"Loading ... "}):Object(h.jsx)("button",{type:"button",onClick:function(){var e=o[o.length-1],t=T(e);v(t,f.page+1)},children:"More"})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(h.jsx)(R,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[63,1,2]]]);
//# sourceMappingURL=main.8fda92ad.chunk.js.map